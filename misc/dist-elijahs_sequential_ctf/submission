I2luY2x1ZGUgPGJpdHMvc3RkYysrLmg+CnVzaW5nIG5hbWVzcGFjZSBzdGQ7CgppbnQgbWFpbigpIHsKICAgIGlvczo6c3luY193aXRoX3N0ZGlvKGZhbHNlKTsKICAgIGNpbi50aWUobnVsbHB0cik7CgogICAgaW50IG47IGNpbiA+PiBuOwogICAgdmVjdG9yPGludD4gYShuKTsKICAgIGZvciAoaW50ICZ4IDogYSkgY2luID4+IHg7CgogICAgY29uc3QgaW50NjRfdCBORUdfSU5GID0gLTFlMTU7CiAgICB2ZWN0b3I8aW50NjRfdD4gZHAoMywgTkVHX0lORik7CiAgICBkcFswXSA9IGRwWzFdID0gZHBbMl0gPSBORUdfSU5GOwoKICAgIC8vIFNhdGlzZmFjdGlvbiBsb29rdXAKICAgIGludCBzWzNdWzNdID0gewogICAgICAgIHswLCAyLCAzfSwKICAgICAgICB7NCwgMCwgNX0sCiAgICAgICAgezEsIDYsIDB9CiAgICB9OwoKICAgIGZvciAoaW50IGMgOiBhKSB7CiAgICAgICAgdmVjdG9yPGludDY0X3Q+IG5ld19kcCA9IGRwOwogICAgICAgIGlmIChuZXdfZHBbY10gPCAwKSBuZXdfZHBbY10gPSAwOyAvLyBzdGFydCBzdWJzZXF1ZW5jZSBoZXJlCgogICAgICAgIGZvciAoaW50IHByZXYgPSAwOyBwcmV2IDwgMzsgcHJldisrKSB7CiAgICAgICAgICAgIGlmIChkcFtwcmV2XSA9PSBORUdfSU5GKSBjb250aW51ZTsKICAgICAgICAgICAgaW50NjRfdCB2YWwgPSBkcFtwcmV2XSArIHNbcHJldl1bY107CiAgICAgICAgICAgIGlmICh2YWwgPiBuZXdfZHBbY10pIG5ld19kcFtjXSA9IHZhbDsKICAgICAgICB9CgogICAgICAgIGRwID0gbW92ZShuZXdfZHApOwogICAgfQoKICAgIGNvdXQgPDwgbWF4KHtkcFswXSwgZHBbMV0sIGRwWzJdfSkgPDwgIlxuIjsKICAgIHJldHVybiAwOwp9Cg==
cpp

